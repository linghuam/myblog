---
title: 一周拾遗2019.12.9-2019.12.15
comments: true
date: 2019-12-16 20:16:22
tags:
categories:
- 一周拾遗
---

## 如何获取浏览器帧率（fps）？

[Web 动画帧率（FPS）计算](https://www.cnblogs.com/coco1s/p/8029582.html)

`帧率`即屏幕的刷新频率，大部分设备为 60次/秒，帧率越大动画越流畅。

```
50~60 FPS：流畅舒适
30~50 FPS：一般
30 FPS 以下：卡顿
```

### 法一：Chrome 开发者工具

More tools -> Rendering -> FPS meter

### 法二：借助 Frame Timing API

一个 Tab 页对应一个进程，`进程 = 主线程(负责计算) + 合成线程(负责绘制)`。

js 动画需要`主线程和合成线程`共同工作，css 动画只需要`合成线程`工作。

### 法三：借助 requestAnimationFrame API

1. 在 canvas 上测试不准确？（ fps meter 的值远远小于 requestAnimationFrame 计算的值）


```js
function fps() {
  var start = 0;
  var frame = 0;
  var allTime = 0;
  var lastTime = 0;
  function render() {
    var now = performance.now();
    allTime += (now - start);
    start = now;
    frame ++;
    if (now - lastTime >= 1000) {
      var fps = 1000 / (allTime / frame);
      console.log('fps:', fps, '\n');
      allTime = 0;
      frame = 0;
      lastTime = now;
    }
    requestAnimationFrame(render);
  };
  requestAnimationFrame(render);
}
```